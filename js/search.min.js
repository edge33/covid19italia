(function(){function j(l,k){var m=$.grep(l,function(p,o){return k.indexOf(p)>=0});return m}function e(m){var k="";k+='<a href="'+m.url+'" class="card mb-15">';k+='<div class="card-body">';if(m.state!="open"){k+="<strike>"}k+='<h4 class="card-title">'+m.title+"</h4>";if(m.state!="open"){k+="</strike>"}k+="<small>";k+="<p>"+m.content.substring(0,250)+"...</p>";k+="<p>"+m.date+"</p>";k+="</small>";k+="</div>";k+='<div class="card-footer">';var n=m.label;var l=j(n,d);k+=l.join("|");k+="</div>";k+="</a>";return k}function c(n,k,p){var o=$("#search-results");if(n.length){var l="";var r=[];for(var m=0;m<n.length;m++){var q=k[n[m].ref];r.push(q)}r=r.sort(function(t,s){return -1*(parseInt(t.created_at)-parseInt(s.created_at))});l+='<div class="col-12">';for(var m=0;m<r.length;m++){var q=r[m];if(q.state=="open"){l+=e(q)}}l+="</div>";l+='<div class="col-12">';for(var m=0;m<r.length;m++){var q=r[m];if(q.state!="open"){l+=e(q)}}l+="</div>";o.html(l)}else{o.html("<li>Nessuna segnalazione trovata</li>")}}function a(m,k){var n=$("#search-results");if(Object.keys(k).length){var l="";var o=[];$.each(k,function(p,q){o.push(q)});o=o.sort(function(q,p){return -1*(parseInt(q.created_at)-parseInt(p.created_at))});l+='<div class="col-12">';$.each(o,function(p,q){if(!m||$.inArray(m,q.label.toLowerCase().split(","))>=0){if(q.state=="open"){l+=e(q)}}});l+="</div>";l+='<div class="col-12">';$.each(o,function(p,q){if(!m||$.inArray(m,q.label.toLowerCase().split(","))>=0){if(q.state!="open"){l+=e(q)}}});l+="</div>";n.html(l)}else{n.html("<li>Nessuna segnalazione trovata</li>")}}function h(k){var m=window.location.search.substring(1);var n=m.split("&");for(var l=0;l<n.length;l++){var o=n[l].split("=");if(o[0]===k){return decodeURIComponent(o[1].replace(/\+/g,"%20"))}}}function f(k,l,o){NProgress.start();if(k){for(var n in window.store){if(!l||$.inArray(l,window.store[n].label.toLowerCase().split(","))>=0){g.addDoc({id:n,title:window.store[n].title,content:window.store[n].content,state:window.store[n].state,date:window.store[n].date,label:window.store[n].label,provincia:window.store[n].provincia,regione:window.store[n].regione})}}var m=g.search(k,{fields:{title:{boost:10},regione:{boost:5},provincia:{boost:5}},bool:"AND"});c(m,window.store,o)}else{a(l,window.store,o)}NProgress.done()}var d=["Alloggi","acquisto solidale","Bambini","Bollettino","Bufale","Contatti","Donazioni","Fabbisogni","Notizie Utili","Ospitalita animali","Raccolte Fondi"];var b=h("query");var i=h("label");if(i){document.getElementById("labelchoice").value=i;i=i.toLowerCase()}NProgress.start();if(b){document.getElementById("search-box").setAttribute("value",b)}var g=elasticlunr(function(){this.use(elasticlunr.it);this.addField("title",{boost:10});this.addField("label");this.addField("content");this.addField("state");this.addField("provincia",{boost:5});this.addField("regione",{boost:5});this.setRef("id")});setTimeout(function(){if(window.store){f(b,i,d)}},0)})();document.getElementById("search-box").onkeydown=function(a){if(a.keyCode==13){NProgress.start()}};